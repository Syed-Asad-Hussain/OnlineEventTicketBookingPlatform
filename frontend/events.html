<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Discover amazing events near you. Browse concerts, conferences, workshops, and more on EventBright.">
    <meta name="keywords" content="events, concerts, conferences, workshops, tickets, event discovery">
    <meta property="og:title" content="Browse Events - EventBright">
    <meta property="og:description" content="Discover amazing events near you">
    <meta property="og:type" content="website">
    <title>Browse Events - EventBright</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">

    <style>
        /* --- GENERAL SETTINGS --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', sans-serif;
        }

        body {
            background-color: #f8f9fa;
            color: #333;
            display: flex;
            flex-direction: column;
            min-height: 100vh;
        }

        a { text-decoration: none; color: inherit; }
        ul { list-style: none; }

        /* --- HEADER --- */
        header {
            background: white;
            padding: 15px 5%;
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
            position: sticky;
            top: 0;
            z-index: 1000;
        }

        .logo {
            font-size: 24px;
            font-weight: 700;
            color: #333;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .logo i { color: #f05537; }

        nav ul { display: flex; gap: 30px; }
        nav ul li a { font-weight: 500; color: #555; transition: 0.3s; }
        nav ul li a:hover, nav ul li a.active { color: #0049ff; font-weight: 600; }

        .auth-buttons { display: flex; gap: 15px; align-items: center; }
        .btn-login { font-weight: 600; }
        .btn-signup {
            background-color: #0049ff; color: white; padding: 10px 25px;
            border-radius: 50px; font-weight: 600; transition: 0.3s;
        }
        .btn-signup:hover { background-color: #0036bd; }

        /* --- MAIN LAYOUT --- */
        .container {
            max-width: 1400px;
            margin: 0 auto;
            padding: 40px 5%;
            width: 100%;
            flex: 1; /* Pushes footer down */
        }

        .page-title {
            font-size: 1.2rem;
            margin-bottom: 20px;
            color: #333;
        }

        /* Search Bar Area */
        .search-area {
            margin-bottom: 30px;
        }
        
        .main-search {
            width: 100%;
            padding: 15px 20px;
            border: 1px solid #ddd;
            border-radius: 8px;
            font-size: 1rem;
            background: white;
            color: #555;
            outline: none;
        }
        .main-search:focus { border-color: #0049ff; }

        /* Layout Grid: Sidebar + Content */
        .content-wrapper {
            display: grid;
            grid-template-columns: 250px 1fr; /* Sidebar fixed width, Content fills rest */
            gap: 40px;
            align-items: start;
        }

        /* --- SIDEBAR FILTERS --- */
        .filter-section {
            background: white;
            padding: 25px;
            border-radius: 15px;
            border: 1px solid #eee;
            margin-bottom: 20px;
        }

        .filter-title {
            font-weight: 600;
            margin-bottom: 15px;
            display: block;
            color: #333;
        }

        .checkbox-group {
            display: flex;
            flex-direction: column;
            gap: 12px;
        }

        .checkbox-item {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.95rem;
            color: #555;
            cursor: pointer;
        }

        .checkbox-item input {
            accent-color: #0049ff;
            width: 16px;
            height: 16px;
        }

        /* --- EVENTS GRID AREA --- */
        .events-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .result-count { color: #666; font-size: 0.95rem; }

        .sort-dropdown {
            padding: 8px 15px;
            border: 1px solid #ddd;
            border-radius: 5px;
            background: white;
            color: #555;
            cursor: pointer;
        }

        .events-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
            gap: 25px;
        }

        /* --- EVENT CARD --- */
        .event-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            border: 1px solid #eee;
            transition: 0.3s;
            display: flex;
            flex-direction: column;
        }

        .event-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 10px 20px rgba(0,0,0,0.08);
        }

        .card-image {
            height: 180px;
            background-color: #eee;
            position: relative;
        }

        .card-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
            display: block; 
        }

        .badge {
            position: absolute;
            top: 15px;
            right: 15px;
            background: white;
            padding: 4px 12px;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 700;
            color: #333;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .card-content {
            padding: 20px;
            display: flex;
            flex-direction: column;
            flex: 1; /* Fills remaining height */
        }

        .event-title {
            font-size: 1.1rem;
            font-weight: 700;
            margin-bottom: 12px;
            color: #222;
        }

        .event-meta {
            color: #666;
            font-size: 0.85rem;
            margin-bottom: 8px;
            display: flex;
            align-items: center;
            gap: 10px;
        }
        .event-meta i { width: 15px; text-align: center; }

        .card-footer {
            margin-top: auto; /* Pushes to bottom */
            padding-top: 20px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .price-label { font-size: 0.85rem; color: #666; }
        .price-value { font-size: 1.1rem; font-weight: 700; color: #0049ff; display: block;}

        .btn-details {
            background: #0049ff;
            color: white;
            padding: 8px 20px;
            border-radius: 50px;
            font-size: 0.9rem;
            font-weight: 600;
            transition: 0.3s;
        }
        .btn-details:hover { background: #0036bd; }

        /* --- FOOTER --- */
        footer {
            background: #0f172a;
            color: white;
            padding: 60px 10% 20px 10%;
            margin-top: 60px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: 1.5fr 1fr 1fr 1fr;
            gap: 40px;
            margin-bottom: 40px;
        }

        .footer-logo { font-size: 1.5rem; font-weight: 700; margin-bottom: 15px; display: flex; align-items: center; gap: 10px; }
        .footer-desc { color: #aaa; line-height: 1.6; font-size: 0.9rem; }
        .footer-col h4 { margin-bottom: 20px; font-size: 1.1rem; }
        .footer-col ul li { margin-bottom: 12px; }
        .footer-col ul li a { color: #aaa; font-size: 0.9rem; transition: 0.3s; }
        .footer-col ul li a:hover { color: white; }
        .copyright { text-align: center; border-top: 1px solid #333; padding-top: 20px; color: #555; font-size: 0.8rem; }

        /* RESPONSIVE */
        @media (max-width: 900px) {
            .content-wrapper { grid-template-columns: 1fr; }
            .filter-section { display: none; /* Hide sidebar on small screens for simplicity */ }
            header { padding: 15px; }
            nav ul { display: none; }
            .footer-content { grid-template-columns: 1fr; }
        }
    </style>
</head>
<body>

    <header>
        <div class="logo">
            <i class="fa-regular fa-calendar-check"></i> EventBright.com
        </div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="events.html" class="active">Events</a></li>
                <li><a href="host-event.html">Host Event</a></li>
                <li><a href="about.html">About</a></li>
            </ul>
        </nav>
        <div class="auth-buttons">
            <a href="auth.html" class="btn-login" aria-label="Login to EventBright">Login</a>
            <a href="auth.html" class="btn-signup" aria-label="Sign up for EventBright">Sign Up</a>
        </div>
    </header>

    <div class="container">
        <h2 class="page-title">Discover Events</h2>
        
        <div class="search-area">
            <input type="text" class="main-search" placeholder="Search events...">
        </div>

        <div class="content-wrapper">
            
            <aside>
                <div class="filter-section">
                    <span class="filter-title">Categories</span>
                    <div class="checkbox-group">
                        <label class="checkbox-item"><input type="checkbox"> Music</label>
                        <label class="checkbox-item"><input type="checkbox"> Tech</label>
                        <label class="checkbox-item"><input type="checkbox"> Art</label>
                        <label class="checkbox-item"><input type="checkbox"> Sports</label>
                        <label class="checkbox-item"><input type="checkbox"> Education</label>
                        <label class="checkbox-item"><input type="checkbox"> Food</label>
                        <label class="checkbox-item"><input type="checkbox"> Corporate</label>
                        <label class="checkbox-item"><input type="checkbox"> Theater</label>
                    </div>
                </div>

                <div class="filter-section">
                    <span class="filter-title">Price Range</span>
                    <div class="checkbox-group">
                        <label class="checkbox-item"><input type="checkbox"> Free</label>
                        <label class="checkbox-item"><input type="checkbox"> Under $50</label>
                        <label class="checkbox-item"><input type="checkbox"> $50 - $100</label>
                        <label class="checkbox-item"><input type="checkbox"> Over $100</label>
                    </div>
                </div>
            </aside>

            <main>
                <div class="events-header">
                    <span class="result-count">8 events found</span>
                    <div class="sort-wrapper">
                        <label style="font-size:0.9rem; color:#666;">Sort by: </label>
                        <select class="sort-dropdown">
                            <option>Date</option>
                            <option>Price: Low to High</option>
                            <option>Price: High to Low</option>
                        </select>
                    </div>
                </div>

                <div class="events-grid">
                    
                    <div class="event-card">
                        <div class="card-image">
                            <img src="https://images.unsplash.com/photo-1460661419201-fd4cecdf8a8b?auto=format&fit=crop&w=600&q=80" alt="Art">
                            <span class="badge">Art</span>
                        </div>
                        <div class="card-content">
                            <div class="event-title">Art Exhibition LA</div>
                            <div class="event-meta"><i class="fa-regular fa-calendar"></i> Nov 10, 2025 at 11:00</div>
                            <div class="event-meta"><i class="fa-solid fa-location-dot"></i> Los Angeles, CA</div>
                            <div class="card-footer">
                                <div><span class="price-label">From</span> <span class="price-value">$35</span></div>
                                <a href="event-details.html?title=Art%20Exhibition%20LA&date=Nov%2010%2C%202025&time=11:00&venue=Los%20Angeles%20Museum&city=Los%20Angeles%2C%20CA&category=Art&price=35&description=Experience%20a%20stunning%20collection%20of%20contemporary%20art%20from%20renowned%20artists%20around%20the%20world.%20This%20exhibition%20features%20paintings%2C%20sculptures%2C%20and%20interactive%20installations%20that%20will%20inspire%20and%20captivate%20art%20enthusiasts." class="btn-details">View Details</a>
                            </div>
                        </div>
                    </div>

                    <div class="event-card">
                        <div class="card-image">
                            <img src="https://images.unsplash.com/photo-1555939594-58d7cb561ad1?auto=format&fit=crop&w=600&q=80" alt="Food">
                            <span class="badge">Food</span>
                        </div>
                        <div class="card-content">
                            <div class="event-title">Street Food Festival</div>
                            <div class="event-meta"><i class="fa-regular fa-calendar"></i> Nov 18, 2025 at 12:00</div>
                            <div class="event-meta"><i class="fa-solid fa-location-dot"></i> Austin, TX</div>
                            <div class="card-footer">
                                <div><span class="price-label">From</span> <span class="price-value">$25</span></div>
                                <a href="event-details.html?title=Street%20Food%20Festival&date=Nov%2018%2C%202025&time=12:00&venue=Austin%20Food%20Market&city=Austin%2C%20TX&category=Food&price=25&description=Join%20us%20for%20an%20amazing%20street%20food%20festival%20featuring%20the%20best%20local%20vendors%20and%20international%20cuisines.%20Enjoy%20live%20music%2C%20cooking%20demonstrations%2C%20and%20delicious%20food%20from%20around%20the%20world." class="btn-details">View Details</a>
                            </div>
                        </div>
                    </div>

                    <div class="event-card">
                        <div class="card-image">
                            <img src="https://images.unsplash.com/photo-1544531586-fde5298cdd40?auto=format&fit=crop&w=600&q=80" alt="Tech">
                            <span class="badge">Tech</span>
                        </div>
                        <div class="card-content">
                            <div class="event-title">Tech Conference 2025</div>
                            <div class="event-meta"><i class="fa-regular fa-calendar"></i> Nov 20, 2025 at 09:00</div>
                            <div class="event-meta"><i class="fa-solid fa-location-dot"></i> San Francisco, CA</div>
                            <div class="card-footer">
                                <div><span class="price-label">From</span> <span class="price-value">$299</span></div>
                                <a href="event-details.html?title=Tech%20Conference%202025&date=Nov%2020%2C%202025&time=09:00&venue=San%20Francisco%20Convention%20Center&city=San%20Francisco%2C%20CA&category=Tech&price=299&description=The%20premier%20technology%20conference%20bringing%20together%20industry%20leaders%2C%20innovators%2C%20and%20tech%20enthusiasts.%20Explore%20cutting-edge%20technologies%2C%20network%20with%20professionals%2C%20and%20discover%20the%20future%20of%20technology." class="btn-details">View Details</a>
                            </div>
                        </div>
                    </div>

                    <div class="event-card">
                        <div class="card-image">
                            <img src="https://images.unsplash.com/photo-1524178232363-1fb2b075b655?auto=format&fit=crop&w=600&q=80" alt="Education">
                            <span class="badge">Education</span>
                        </div>
                        <div class="card-content">
                            <div class="event-title">Digital Marketing Workshop</div>
                            <div class="event-meta"><i class="fa-regular fa-calendar"></i> Nov 25, 2025 at 10:00</div>
                            <div class="event-meta"><i class="fa-solid fa-location-dot"></i> Boston, MA</div>
                            <div class="card-footer">
                                <div><span class="price-label">From</span> <span class="price-value">$199</span></div>
                                <a href="event-details.html?title=Digital%20Marketing%20Workshop&date=Nov%2025%2C%202025&time=10:00&venue=Boston%20Business%20Center&city=Boston%2C%20MA&category=Education&price=199&description=Learn%20the%20latest%20digital%20marketing%20strategies%20and%20techniques%20from%20industry%20experts.%20This%20hands-on%20workshop%20covers%20SEO%2C%20social%20media%20marketing%2C%20content%20strategy%2C%20and%20analytics." class="btn-details">View Details</a>
                            </div>
                        </div>
                    </div>



                    <div class="event-card">
                        <div class="card-image">
                            <img src="https://images.unsplash.com/photo-1461896836934-ffe607ba8211?auto=format&fit=crop&w=600&q=80" alt="Sports">
                            <span class="badge">Sports</span>
                        </div>
                        <div class="card-content">
                            <div class="event-title">Championship Game</div>
                            <div class="event-meta"><i class="fa-regular fa-calendar"></i> Dec 1, 2025 at 19:00</div>
                            <div class="event-meta"><i class="fa-solid fa-location-dot"></i> Chicago, IL</div>
                            <div class="card-footer">
                                <div><span class="price-label">From</span> <span class="price-value">$125</span></div>
                                <a href="event-details.html?title=Championship%20Game&date=Dec%201%2C%202025&time=19:00&venue=Chicago%20Stadium&city=Chicago%2C%20IL&category=Sports&price=125&description=Don%27t%20miss%20the%20thrilling%20championship%20game%20featuring%20top%20teams%20competing%20for%20the%20title.%20Experience%20the%20excitement%20of%20live%20sports%20action%20in%20a%20world-class%20venue." class="btn-details">View Details</a>
                            </div>
                        </div>
                    </div>

                     <div class="event-card">
                        <div class="card-image">
                            <img src="https://images.unsplash.com/photo-1515187029135-18ee286d815b?auto=format&fit=crop&w=600&q=80" alt="Corporate">
                            <span class="badge">Corporate</span>
                        </div>
                        <div class="card-content">
                            <div class="event-title">Business Networking Summit</div>
                            <div class="event-meta"><i class="fa-regular fa-calendar"></i> Dec 5, 2025 at 08:30</div>
                            <div class="event-meta"><i class="fa-solid fa-location-dot"></i> Seattle, WA</div>
                            <div class="card-footer">
                                <div><span class="price-label">From</span> <span class="price-value">$149</span></div>
                                <a href="event-details.html?title=Business%20Networking%20Summit&date=Dec%205%2C%202025&time=08:30&venue=Seattle%20Convention%20Center&city=Seattle%2C%20WA&category=Corporate&price=149&description=Connect%20with%20industry%20leaders%2C%20entrepreneurs%2C%20and%20professionals%20at%20this%20exclusive%20networking%20summit.%20Features%20keynote%20speakers%2C%20panel%20discussions%2C%20and%20valuable%20business%20opportunities." class="btn-details">View Details</a>
                            </div>
                        </div>
                    </div>

                </div>

                <!-- Pagination -->
                <div class="pagination" id="pagination" role="navigation" aria-label="Event pagination" style="display: none; margin-top: 40px;">
                    <button id="prevPage" class="pagination-btn" aria-label="Previous page" disabled>
                        <i class="fa-solid fa-chevron-left"></i> Previous
                    </button>
                    <span class="pagination-info" id="paginationInfo" aria-live="polite">Page 1 of 1</span>
                    <button id="nextPage" class="pagination-btn" aria-label="Next page">
                        Next <i class="fa-solid fa-chevron-right"></i>
                    </button>
                </div>
            </main>
        </div>
    </div>

    <footer>
        <div class="footer-content">
            <div class="footer-col">
                <div class="footer-logo">
                    <i class="fa-regular fa-calendar-check" style="color:#f05537;"></i> EventBright.com
                </div>
                <p class="footer-desc">Your premier platform for discovering and hosting amazing events worldwide. Join our community today.</p>
            </div>
            
            <div class="footer-col">
                <h4>Quick Links</h4>
                <ul>
                    <li><a href="events.html">Browse Events</a></li>
                    <li><a href="host-event.html">Host an Event</a></li>
                    <li><a href="#">Pricing</a></li>
                    <li><a href="#">Help Center</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h4>Categories</h4>
                <ul>
                    <li><a href="#">Music</a></li>
                    <li><a href="#">Technology</a></li>
                    <li><a href="#">Arts & Culture</a></li>
                    <li><a href="#">Sports</a></li>
                </ul>
            </div>

            <div class="footer-col">
                <h4>Contact Us</h4>
                <ul class="contact-info">
                    <li><i class="fa-regular fa-envelope"></i> support@eventbright.com</li>
                    <li><i class="fa-solid fa-phone"></i> 1-800-EVENT-00</li>
                    <li><i class="fa-solid fa-location-dot"></i> San Francisco, CA</li>
                </ul>
            </div>
        </div>
        <div class="copyright">
            &copy; 2025 EventBright.com. All Rights Reserved.
        </div>
    </footer>
<!-- Your full existing HTML content remains unchanged above this line -->
<script>
  // Normalize category and title keys
  function normalizeCategory(raw) {
    if (!raw) return "general";
    return String(raw).trim().toLowerCase();
  }

  function normalizeTitle(raw) {
    return String(raw || "").trim().toLowerCase();
  }

  // Map categories to image keywords
  function getImageKeyword(category) {
    const map = {
      "food & drink": "food",
      "technology": "tech",
      "music": "concert",
      "corporate": "business",
      "art": "art",
      "sports": "sports",
      "education": "education",
      "theater": "theater",
      "theatre": "theater",
      "general": "event"
    };
    return map[category] || "event";
  }

  // Reliable images per keyword
  const keywordImages = {
    food: "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?auto=format&fit=crop&w=600&q=80",
    tech: "https://images.unsplash.com/photo-1544531586-fde5298cdd40?auto=format&fit=crop&w=600&q=80",
    concert: "https://images.unsplash.com/photo-1511376777868-611b54f68947?auto=format&fit=crop&w=600&q=80",
    business: "https://images.unsplash.com/photo-1515187029135-18ee286d815b?auto=format&fit=crop&w=600&q=80",
    art: "https://images.unsplash.com/photo-1460661419201-fd4cecdf8a8b?auto=format&fit=crop&w=600&q=80",
    sports: "https://images.unsplash.com/photo-1461896836934-ffe607ba8211?auto=format&fit=crop&w=600&q=80",
    education: "https://images.unsplash.com/photo-1524178232363-1fb2b075b655?auto=format&fit=crop&w=600&q=80",
    theater: "https://plus.unsplash.com/premium_photo-1682855223630-6953b8f83eb8?q=80&w=687&auto=format&fit=crop&ixlib=rb-4.1.0",
    event: "https://images.unsplash.com/photo-1503428593586-e225b39bddfe?auto=format&fit=crop&w=600&q=80"
  };

  // Exact image overrides for specific titles
  const titleOverrides = {
    "newyeareve": "https://plus.unsplash.com/premium_photo-1683129651802-1c7ba429a137?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0",
    "music fest nyc": "https://copilot.microsoft.com/th/id/BCO.d3ca094c-3e73-4707-a2eb-291f82289a05.png",
    "business networking summit": "https://images.unsplash.com/photo-1557804506-669a67965ba0?auto=format&fit=crop&w=600&q=80",
    "championship game": "https://images.unsplash.com/photo-1514088932429-d2b36b86fc89?auto=format&fit=crop&w=600&q=80",
    "karachieat": "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?auto=format&fit=crop&w=600&q=80",
    "tech01": "https://images.unsplash.com/photo-1518770660439-4636190af475?auto=format&fit=crop&w=600&q=80"
  };

  const ultimateFallback = "https://images.unsplash.com/photo-1503428593586-e225b39bddfe?auto=format&fit=crop&w=600&q=80";

  function pickImageUrl(event) {
    const titleKey = normalizeTitle(event.title);
    if (titleOverrides[titleKey]) return titleOverrides[titleKey];

    const categoryNorm = normalizeCategory(event.category);
    const keyword = getImageKeyword(categoryNorm);
    return keywordImages[keyword] || keywordImages["event"] || ultimateFallback;
  }

  // Parse date from event card (handles various formats)
  function parseEventDate(card) {
    const dateMeta = card.querySelector('.event-meta');
    if (!dateMeta) return new Date(0); // Return epoch if no date found
    
    const dateText = dateMeta.textContent.trim();
    
    // Try to parse as ISO date first (YYYY-MM-DD)
    const isoMatch = dateText.match(/(\d{4})-(\d{2})-(\d{2})/);
    if (isoMatch) {
      return new Date(parseInt(isoMatch[1]), parseInt(isoMatch[2]) - 1, parseInt(isoMatch[3]));
    }
    
    // Try format: "Nov 10, 2025" or "November 10, 2025"
    const dateMatch = dateText.match(/([A-Za-z]+)\s+(\d+),\s+(\d+)/);
    if (dateMatch) {
      const monthNames = {
        'jan': 0, 'january': 0, 'feb': 1, 'february': 1, 'mar': 2, 'march': 2,
        'apr': 3, 'april': 3, 'may': 4, 'jun': 5, 'june': 5,
        'jul': 6, 'july': 6, 'aug': 7, 'august': 7, 'sep': 8, 'september': 8,
        'oct': 9, 'october': 9, 'nov': 10, 'november': 10, 'dec': 11, 'december': 11
      };
      
      const monthKey = dateMatch[1].toLowerCase();
      const month = monthNames[monthKey] !== undefined ? monthNames[monthKey] : 
                    monthNames[monthKey.substring(0, 3)];
      const day = parseInt(dateMatch[2]);
      const year = parseInt(dateMatch[3]);
      
      if (month !== undefined) {
        return new Date(year, month, day);
      }
    }
    
    // Try to parse as Date object directly
    const parsed = new Date(dateText);
    if (!isNaN(parsed.getTime())) {
      return parsed;
    }
    
    // Return epoch if parsing fails
    return new Date(0);
  }

  // Parse price from event card
  function parseEventPrice(card) {
    const priceElement = card.querySelector('.price-value');
    if (!priceElement) return 0;
    
    const priceText = priceElement.textContent.trim().toLowerCase();
    if (priceText === 'free') return 0;
    
    const priceMatch = priceText.match(/\$?(\d+(?:\.\d+)?)/);
    return priceMatch ? parseFloat(priceMatch[1]) : 0;
  }

  // Sort events based on selected option
  function sortEvents(sortOption) {
    const grid = document.querySelector('.events-grid');
    if (!grid) return;
    
    const cards = Array.from(grid.querySelectorAll('.event-card'));
    if (cards.length === 0) return;
    
    // Sort cards based on option
    cards.sort((a, b) => {
      if (sortOption === 'Date') {
        const dateA = parseEventDate(a);
        const dateB = parseEventDate(b);
        return dateA - dateB; // Ascending (earliest first)
      } else if (sortOption === 'Price: Low to High') {
        const priceA = parseEventPrice(a);
        const priceB = parseEventPrice(b);
        return priceA - priceB; // Ascending (lowest first)
      } else if (sortOption === 'Price: High to Low') {
        const priceA = parseEventPrice(a);
        const priceB = parseEventPrice(b);
        return priceB - priceA; // Descending (highest first)
      }
      return 0;
    });
    
    // Clear grid and re-append sorted cards
    grid.innerHTML = '';
    cards.forEach(card => {
      grid.appendChild(card);
    });
  }

  // Pagination state
  let currentPage = 1;
  let totalPages = 1;
  let currentSort = 'date';
  let currentSortOrder = 'ASC';

  async function loadNewEvents(page = 1, sortBy = 'date', sortOrder = 'ASC') {
    try {
      const params = new URLSearchParams({
        page: page.toString(),
        limit: '12',
        sortBy: sortBy,
        sortOrder: sortOrder
      });

      const res = await fetch(`http://localhost:5000/api/events?${params.toString()}`);
      const data = await res.json();

      const grid = document.querySelector(".events-grid");
      if (!grid) return;

      // Clear existing events (except static ones)
      const staticCards = grid.querySelectorAll('.event-card:not([data-dynamic])');
      grid.innerHTML = '';
      staticCards.forEach(card => grid.appendChild(card));

      // Update pagination
      if (data.pagination) {
        currentPage = data.pagination.page;
        totalPages = data.pagination.pages;
        updatePagination(data.pagination);
        updateResultCount(data.pagination.total);
      }

      const events = data.events || (Array.isArray(data) ? data : []);
      if (events.length === 0 && page === 1) {
        // Show static events if no API events
        return;
      }

      events.forEach(event => {
        const imageUrl = pickImageUrl(event);

        const categoryNorm = normalizeCategory(event.category || "general");
        const categoryLabel = categoryNorm
          .split(" ")
          .map(w => w.charAt(0).toUpperCase() + w.slice(1))
          .join(" ");

        const title = event.title || "Untitled Event";
        const date = event.date || "Date TBA";
        const time = event.time || "Time TBA";
        const venue = event.venue || "Venue TBA";
        const city = event.city || "City TBA";
        const price = event.price ? `$${event.price}` : "Free";
        const priceValue = event.price || 0;
        const description = event.description || "Join us for an amazing event experience!";

        // Build query parameters for event details page
        const params = new URLSearchParams({
          title: title,
          date: date,
          time: time,
          venue: venue,
          city: city,
          category: event.category || categoryLabel,
          price: priceValue.toString(),
          description: description
        });

        // If event has an ID, include it
        if (event.id) {
          params.set('id', event.id.toString());
        }

        const detailsUrl = `event-details.html?${params.toString()}`;

        const card = document.createElement("div");
        card.className = "event-card";
        card.setAttribute('data-dynamic', 'true');
        card.setAttribute('role', 'listitem');
        card.innerHTML = `
          <div class="card-image">
            <img src="${imageUrl}" alt="${categoryLabel}" onerror="this.src='${ultimateFallback}'" />
            <span class="badge">${categoryLabel}</span>
          </div>
          <div class="card-content">
            <div class="event-title">${title}</div>
            <div class="event-meta"><i class="fa-regular fa-calendar"></i> ${date} at ${time}</div>
            <div class="event-meta"><i class="fa-solid fa-location-dot"></i> ${venue}, ${city}</div>
            <div class="card-footer">
              <div><span class="price-label">From</span> <span class="price-value">${price}</span></div>
              <a href="${detailsUrl}" class="btn-details">View Details</a>
            </div>
          </div>
        `;
        grid.appendChild(card);
      });
      
    } catch (err) {
      console.error("âŒ Failed to load new events:", err?.message || err);
      updateResultCount(0, true);
    }
  }

  function updatePagination(pagination) {
    const paginationEl = document.getElementById('pagination');
    const prevBtn = document.getElementById('prevPage');
    const nextBtn = document.getElementById('nextPage');
    const infoEl = document.getElementById('paginationInfo');

    if (!paginationEl || !prevBtn || !nextBtn || !infoEl) return;

    paginationEl.style.display = pagination.pages > 1 ? 'flex' : 'none';
    prevBtn.disabled = pagination.page <= 1;
    nextBtn.disabled = pagination.page >= pagination.pages;
    infoEl.textContent = `Page ${pagination.page} of ${pagination.pages}`;
  }

  function updateResultCount(total, isError = false) {
    const countEl = document.getElementById('resultCount');
    if (!countEl) return;
    
    if (isError) {
      countEl.textContent = 'Error loading events';
    } else {
      countEl.textContent = `${total} event${total !== 1 ? 's' : ''} found`;
    }
  }

  // Pagination handlers
  document.addEventListener('DOMContentLoaded', () => {
    const prevBtn = document.getElementById('prevPage');
    const nextBtn = document.getElementById('nextPage');
    const sortDropdown = document.getElementById('sortDropdown');

    if (prevBtn) {
      prevBtn.addEventListener('click', () => {
        if (currentPage > 1) {
          loadNewEvents(currentPage - 1, currentSort, currentSortOrder);
        }
      });
    }

    if (nextBtn) {
      nextBtn.addEventListener('click', () => {
        if (currentPage < totalPages) {
          loadNewEvents(currentPage + 1, currentSort, currentSortOrder);
        }
      });
    }

    if (sortDropdown) {
      sortDropdown.addEventListener('change', (e) => {
        const value = e.target.value;
        if (value === 'price-asc') {
          currentSort = 'price';
          currentSortOrder = 'ASC';
        } else if (value === 'price-desc') {
          currentSort = 'price';
          currentSortOrder = 'DESC';
        } else {
          currentSort = 'date';
          currentSortOrder = 'ASC';
        }
        loadNewEvents(1, currentSort, currentSortOrder);
      });
    }

    // Load initial events
    loadNewEvents();
  });
</script>

<script>
  document.querySelector('.main-search').addEventListener('input', function(e) {
    const query = e.target.value.toLowerCase();
    const cards = document.querySelectorAll('.event-card');

    cards.forEach(card => {
      const title = card.querySelector('.event-title').textContent.toLowerCase();
      const location = card.querySelector('.event-meta:nth-of-type(2)').textContent.toLowerCase();
      const category = card.querySelector('.badge').textContent.toLowerCase();

      const matches = title.includes(query) || location.includes(query) || category.includes(query);
      card.style.display = matches ? 'block' : 'none';
    });
  });
</script>

<script>
  function applyFilters() {
    const selectedCategories = Array.from(document.querySelectorAll('.checkbox-group input[type="checkbox"]:checked'))
      .map(cb => cb.parentElement.textContent.trim().toLowerCase());

    const cards = document.querySelectorAll('.event-card');

    cards.forEach(card => {
      const category = card.querySelector('.badge').textContent.trim().toLowerCase();
      const priceText = card.querySelector('.price-value').textContent.replace('$', '').trim();
      const price = parseFloat(priceText) || 0;

      let categoryMatch = selectedCategories.length === 0 || selectedCategories.includes(category);
      let priceMatch = true;

      if (selectedCategories.includes('free')) {
        priceMatch = price === 0;
      } else if (selectedCategories.includes('under $50')) {
        priceMatch = price < 50;
      } else if (selectedCategories.includes('$50 - $100')) {
        priceMatch = price >= 50 && price <= 100;
      } else if (selectedCategories.includes('over $100')) {
        priceMatch = price > 100;
      }

      card.style.display = categoryMatch && priceMatch ? 'block' : 'none';
    });
  }

  // Listen for checkbox changes
  document.querySelectorAll('.checkbox-group input[type="checkbox"]').forEach(cb => {
    cb.addEventListener('change', applyFilters);
  });
</script>

<script>
  function parsePrice(text) {
    const t = String(text || "").trim().toLowerCase();
    if (t.includes("free")) return 0;
    const num = parseFloat(t.replace(/[^0-9.]/g, ""));
    return isNaN(num) ? null : num;
  }

  function getSelectedPriceRanges() {
    return Array.from(document.querySelectorAll('input[data-filter="price"]:checked'))
      .map(cb => cb.value.toLowerCase());
  }

  function matchesPriceRange(price, selectedRanges) {
    if (selectedRanges.length === 0) return true;
    if (price === null) return false;

    return selectedRanges.some(range => {
      switch (range) {
        case "free": return price === 0;
        case "under50": return price > 0 && price < 50;
        case "50to100": return price >= 50 && price <= 100;
        case "over100": return price > 100;
        default: return true;
      }
    });
  }

  function applyPriceFilter() {
    const selectedRanges = getSelectedPriceRanges();
    const cards = document.querySelectorAll(".event-card");

    cards.forEach(card => {
      const priceText = card.querySelector(".price-value")?.textContent || "";
      const price = parsePrice(priceText);
      const show = matchesPriceRange(price, selectedRanges);
      card.style.display = show ? "block" : "none";
    });

    const visibleCount = Array.from(cards).filter(c => c.style.display !== "none").length;
    const resultCountEl = document.querySelector(".result-count");
    if (resultCountEl) resultCountEl.textContent = `${visibleCount} events found`;
  }

  window.addEventListener("DOMContentLoaded", () => {
    document.querySelectorAll('input[data-filter="price"]').forEach(cb => {
      cb.addEventListener("change", applyPriceFilter);
    });
    applyPriceFilter();
  });
</script>

<script>
  // Add event listener to sort dropdown
  window.addEventListener('DOMContentLoaded', () => {
    const sortDropdown = document.querySelector('.sort-dropdown');
    if (sortDropdown) {
      sortDropdown.addEventListener('change', (e) => {
        const selectedOption = e.target.value;
        sortEvents(selectedOption);
      });
    }
  });
</script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        const eventsGrid = document.querySelector('.events-grid');
        const resultCount = document.querySelector('.result-count');

        // Function to recount visible events
        function updateLiveCount() {
            // Select only cards that are NOT hidden
            const visibleCards = document.querySelectorAll('.event-card:not([style*="display: none"])');
            if (resultCount) {
                resultCount.textContent = `${visibleCards.length} events found`;
            }
        }

        // 1. Run immediately in case events are already there
        updateLiveCount();

        // 2. Set up a "Watcher" (MutationObserver)
        // This watches the grid for ANY changes (new items added, filtering hidden/shown)
        const observer = new MutationObserver(() => {
            updateLiveCount();
        });

        if (eventsGrid) {
            observer.observe(eventsGrid, { 
                childList: true,  // Watch for new events added
                subtree: true,    // Watch inside the grid
                attributes: true, // Watch for style changes (filtering)
                attributeFilter: ['style'] // Only care if style changes (hide/show)
            });
        }
    });
</script>
<script>
    document.addEventListener('DOMContentLoaded', () => {
        // Select elements
        const eventsGrid = document.querySelector('.events-grid');
        const searchInput = document.querySelector('.main-search');
        const checkboxes = document.querySelectorAll('input[type="checkbox"]');
        const resultCount = document.querySelector('.result-count');
        const sortDropdown = document.getElementById('sortDropdown');

        // Reset filters on load
        if(searchInput) searchInput.value = "";
        checkboxes.forEach(cb => cb.checked = false);

        // --- 1. KEY FIX: IMAGE SELECTION FUNCTION ---
        function getEventImage(event) {
            // Priority 1: Check Database for uploaded image
            let imagePath = event.image || event.imageUrl;
            if (imagePath && imagePath.trim() !== "") {
                imagePath = imagePath.replace(/\\/g, '/'); // Fix backslashes
                if (imagePath.startsWith('http') || imagePath.startsWith('data:')) {
                    return imagePath;
                }
                return `http://localhost:5000/${imagePath}`;
            }

            // Priority 2: Check Title Overrides (Specific images for specific titles)
            const titleKey = (event.title || "").toLowerCase().trim();
            const overrides = {
                "newyeareve": "https://plus.unsplash.com/premium_photo-1683129651802-1c7ba429a137?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0",
                "music fest nyc": "https://copilot.microsoft.com/th/id/BCO.d3ca094c-3e73-4707-a2eb-291f82289a05.png",
                "music_fest": "https://copilot.microsoft.com/th/id/BCO.d3ca094c-3e73-4707-a2eb-291f82289a05.png", 
                "business networking summit": "https://images.unsplash.com/photo-1557804506-669a67965ba0?auto=format&fit=crop&w=600&q=80",
                "championship game": "https://images.unsplash.com/photo-1514088932429-d2b36b86fc89?auto=format&fit=crop&w=600&q=80",
                "karachieat": "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?auto=format&fit=crop&w=600&q=80",
                "tech01": "https://images.unsplash.com/photo-1518770660439-4636190af475?auto=format&fit=crop&w=600&q=80"
            };
            
            if (overrides[titleKey]) return overrides[titleKey];

            // Priority 3: Fallback to Category Stock Image
            const category = (event.category || "general").toLowerCase();
            return getStockImage(category);
        }

        // --- 2. STOCK IMAGE FALLBACKS ---
        function getStockImage(category) {
            const images = {
                "food": "https://images.unsplash.com/photo-1555939594-58d7cb561ad1?w=600&q=80",
                "tech": "https://images.unsplash.com/photo-1544531586-fde5298cdd40?w=600&q=80",
                "art": "https://images.unsplash.com/photo-1460661419201-fd4cecdf8a8b?w=600&q=80",
                "music": "https://images.unsplash.com/photo-1566737236500-c8ac43014a67?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
                "sports": "https://images.unsplash.com/photo-1461896836934-ffe607ba8211?w=600&q=80",
                "business": "https://images.unsplash.com/photo-1515187029135-18ee286d815b?w=600&q=80",
                "education": "https://images.unsplash.com/photo-1524178232363-1fb2b075b655?w=600&q=80",
                "default": "https://images.unsplash.com/photo-1531058020387-3be344556be6?q=80&w=1170&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D"
            };
            // Match partial keywords (e.g. "food & drink" -> "food")
            const key = Object.keys(images).find(k => category.includes(k)) || "default";
            return images[key];
        }

        // --- 3. FETCH AND RENDER EVENTS ---
        async function loadEvents() {
            try {
                const res = await fetch('http://localhost:5000/api/events');
                const data = await res.json();
                const events = Array.isArray(data) ? data : (data.events || []);

                // Keep static cards, remove old dynamic ones
                const staticCards = Array.from(document.querySelectorAll('.event-card:not([data-dynamic])'));
                eventsGrid.innerHTML = '';
                staticCards.forEach(c => eventsGrid.appendChild(c));

                events.forEach(event => {
                    // USE THE FIX HERE
                    const imageUrl = getEventImage(event);
                    
                    const dateStr = event.date ? new Date(event.date).toLocaleDateString() : "Date TBA";
                    const priceDisplay = event.price ? `$${event.price}` : "Free";
                    
                    const card = document.createElement('div');
                    card.className = 'event-card';
                    card.setAttribute('data-dynamic', 'true');
                    
                    // Construct URL for details page
                    const params = new URLSearchParams({
                        id: event._id || event.id,
                        title: event.title,
                        image: imageUrl, // Pass the fixed URL
                        date: dateStr,
                        location: event.city || event.venue,
                        price: event.price || 0,
                        desc: event.description
                    });

                    card.innerHTML = `
                        <div class="card-image">
                            <img src="${imageUrl}" alt="${event.title}" onerror="this.src='${getStockImage('default')}'">
                            <span class="badge">${event.category || 'Event'}</span>
                        </div>
                        <div class="card-content">
                            <div class="event-title">${event.title || 'Untitled'}</div>
                            <div class="event-meta"><i class="fa-regular fa-calendar"></i> ${dateStr}</div>
                            <div class="event-meta"><i class="fa-solid fa-location-dot"></i> ${event.city || 'Online'}</div>
                            <div class="card-footer">
                                <div><span class="price-label">From</span> <span class="price-value">${priceDisplay}</span></div>
                                <a href="event-details.html?${params.toString()}" class="btn-details">View Details</a>
                            </div>
                        </div>
                    `;
                    eventsGrid.appendChild(card);
                });

                // Update count
                if(resultCount) resultCount.innerText = `${events.length + staticCards.length} events found`;

                // Re-attach filtering logic
                attachFilters();

            } catch (err) {
                console.error("Error loading events:", err);
            }
        }

        // --- 4. FILTER & SORT LOGIC ---
        function attachFilters() {
            function filter() {
                const query = searchInput.value.toLowerCase();
                const cards = document.querySelectorAll('.event-card');
                let count = 0;

                cards.forEach(card => {
                    const text = card.innerText.toLowerCase();
                    if(text.includes(query)) {
                        card.style.display = "";
                        count++;
                    } else {
                        card.style.display = "none";
                    }
                });
                if(resultCount) resultCount.innerText = `${count} events found`;
            }

            if(searchInput) searchInput.addEventListener('input', filter);
        }

        // Initialize
        loadEvents();
    });
</script>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        // --- 1. CHECK LOGIN STATUS ---
// --- REPLACE YOUR EXISTING AUTH LOGIC WITH THIS ---

const authButtons = document.querySelector('.auth-buttons');
const username = localStorage.getItem('username');

if (username && authButtons) {
    // User is Logged In: Show Profile Link + Logout
    authButtons.innerHTML = `
        <div style="display: flex; align-items: center; gap: 15px;">
            <a href="profile.html" style="text-decoration: none; color: #333; font-weight: 600; display: flex; align-items: center; gap: 8px; cursor: pointer;">
                <div style="width: 32px; height: 32px; background: #e0e7ff; color: #0049ff; border-radius: 50%; display: flex; align-items: center; justify-content: center;">
                    <i class="fa-regular fa-user"></i>
                </div>
                Hi, ${username}
            </a>

            <button id="logoutBtn" style="background: #333; color: white; border: none; padding: 8px 20px; border-radius: 50px; font-weight: 600; cursor: pointer; transition: 0.3s; font-size: 0.9rem;">
                Logout
            </button>
        </div>
    `;

    // Attach Logout Functionality
    document.getElementById('logoutBtn').addEventListener('click', async () => {
        try { 
            await fetch('http://localhost:5000/api/auth/logout', { method: 'POST', credentials: 'include' }); 
        } catch (err) {
            console.log("Logout error", err);
        }
        localStorage.removeItem('username'); 
        window.location.href = 'auth.html'; 
    });
}
    });
</script>


</body>
</html>


